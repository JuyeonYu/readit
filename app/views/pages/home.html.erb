<% content_for(:title) { "읽었어? - 읽음 확인 링크 서비스" } %>

<main class="landing">
  <section class="hero">
    <h1>읽었어?</h1>
    <p class="tagline">메시지를 보냈는데, 읽었는지 궁금할 때</p>
  </section>

  <% if logged_in? %>
    <section class="user-actions">
      <div class="action-buttons">
        <%= link_to "새 메시지", new_message_path, class: "btn-primary" %>
        <%= link_to "알림 목록", notifications_path, class: "btn-secondary" %>
      </div>
    </section>

    <section class="sent-messages">
      <div class="section-header">
        <h2>보낸 메시지</h2>
      </div>

      <% if @messages.any? %>
        <ul class="message-list">
          <% @messages.each do |message| %>
            <li class="message-item">
              <%= link_to share_message_path(message.token), class: "message-link" do %>
                <div class="message-preview">
                  <p class="message-excerpt"><%= truncate(message.content, length: 80) %></p>
                  <div class="message-meta">
                    <span class="read-count">읽음 <%= message.read_count %>회</span>
                    <span class="created-at"><%= time_ago_in_words(message.created_at) %> 전</span>
                    <% if message.expires_at.present? %>
                      <% if message.expires_at.future? %>
                        <span class="expires-badge">만료: <%= message.expires_at.strftime("%m/%d %H:%M") %></span>
                      <% else %>
                        <span class="expired-badge">만료됨</span>
                      <% end %>
                    <% end %>
                    <% if message.password_digest.present? %>
                      <span class="password-badge">비밀번호</span>
                    <% end %>
                    <% if message.max_read_count.present? %>
                      <span class="limit-badge">제한: <%= message.max_read_count %>회</span>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="empty-state">
          <p>아직 보낸 메시지가 없습니다.</p>
          <p>첫 번째 메시지를 만들어보세요!</p>
        </div>
      <% end %>
    </section>
  <% else %>
    <section class="description">
      <p>
        중요한 메시지를 보냈는데 상대가 확인했는지 알 수 없어 답답하셨나요?
      </p>
      <p>
        <strong>읽었어?</strong>는 링크로 메시지를 공유하고,
        상대가 읽으면 알림을 받을 수 있는 서비스입니다.
      </p>
    </section>

    <section class="features">
      <ul>
        <li>설치 없이 웹에서 바로 사용</li>
        <li>로그인 없이 간편하게</li>
        <li>개인정보 최소 수집</li>
      </ul>
    </section>

    <section class="cta">
      <%= link_to "메시지 만들어보기", new_message_path, class: "btn-primary" %>
    </section>

    <section class="login-prompt">
      <p>이미 계정이 있으신가요? 로그인하면 보낸 메시지를 확인할 수 있어요.</p>
      <%= link_to "로그인", login_path, class: "btn-secondary" %>
    </section>
  <% end %>
</main>
