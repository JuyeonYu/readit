<% content_for(:title) { "읽었어? - 읽음 확인 링크 서비스" } %>

<main class="landing">
  <section class="hero">
    <h1>읽었어?</h1>
    <p class="tagline">메시지를 보냈는데, 읽었는지 궁금할 때</p>
  </section>

  <% if logged_in? %>
    <section class="cta">
      <%= link_to "새 메시지", new_message_path, class: "btn-primary" %>
    </section>

    <section class="sent-messages">
      <div class="section-header">
        <h2>보낸 메시지</h2>
      </div>

      <% if @messages.any? %>
        <ul class="message-list">
          <% @messages.each do |message| %>
            <li class="message-item">
              <%= link_to share_message_path(message.token), class: "message-link" do %>
                <div class="message-preview">
                  <p class="message-excerpt"><%= truncate(message.title, length: 80) %></p>
                  <div class="message-meta">
                    <span class="read-count"><%= message.unique_reader_count %>명 / <%= message.read_count %>회</span>
                    <span class="created-at"><%= time_ago_in_words(message.created_at) %> 전</span>
                    <% if message.expires_at.present? %>
                      <% if message.expires_at.future? %>
                        <span class="expires-badge">만료: <%= format_date_short(message.expires_at) %></span>
                      <% else %>
                        <span class="expired-badge">만료됨</span>
                      <% end %>
                    <% end %>
                    <% if message.password_digest.present? %>
                      <span class="password-badge">비밀번호</span>
                    <% end %>
                    <% if message.max_read_count.present? %>
                      <span class="limit-badge">제한: <%= message.max_read_count %>회</span>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="empty-state">
          <p>아직 보낸 메시지가 없습니다.</p>
          <p>첫 번째 메시지를 만들어보세요!</p>
        </div>
      <% end %>
    </section>
  <% else %>
    <section class="value-prop">
      <div class="problem">
        <p class="problem-text">"확인 좀 해줘" 라고 또 보내기 민망할 때,</p>
      </div>
      <div class="solution">
        <p>링크 하나로 <strong>읽었는지 알림</strong>을 받으세요.</p>
      </div>
    </section>

    <section class="how-it-works">
      <h2>이렇게 동작해요</h2>
      <ol class="steps">
        <li>
          <span class="step-number">1</span>
          <span class="step-text">메시지를 작성하면 <strong>고유 링크</strong>가 생성돼요</span>
        </li>
        <li>
          <span class="step-number">2</span>
          <span class="step-text">링크를 카톡, 메일 등으로 공유하세요</span>
        </li>
        <li>
          <span class="step-number">3</span>
          <span class="step-text">상대가 열어보면 <strong>이메일로 알림</strong>이 와요</span>
        </li>
      </ol>
    </section>

    <section class="features">
      <ul>
        <li>받는 사람은 가입 없이 바로 열람</li>
        <li>1회 읽기, 만료 시간, 비밀번호 설정 가능</li>
        <li>누가 몇 번 읽었는지 기록</li>
      </ul>
    </section>

    <section class="cta-section">
      <%= link_to "시작하기", login_path, class: "btn-primary btn-large" %>
      <p class="cta-hint">이메일로 간편 로그인</p>
    </section>
  <% end %>
</main>
